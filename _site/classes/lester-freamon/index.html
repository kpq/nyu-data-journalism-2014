<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Doing the dirty work</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/assets/base.css">
        <link rel="stylesheet" href="/assets/syntax.css">

        <!-- Custom CSS -->
        <!-- <link rel="stylesheet" href="/assets/main.css"> -->

        <script src="/assets/d3.v3.min.js" charset="utf-8"></script>
        <script src="/assets/topojson.v1.min.js" charset="utf-8"></script>
        <script src="/assets/queue.v1.min.js" charset="utf-8"></script>
    </head>
    <body>
        <div class="main">

            <header>
  <a href="/">NYU — Spring 2014</a> / <span>Week 1</span>
</header>

<h1>Doing the dirty work</h1>

<div class="lesson">
  <p>The big 4 – sorting, filtering, aggregating and merging – are enough to help you answer 99 percent of data questions. But most of the time, your data doesn&rsquo;t come ready to party. Today we&rsquo;ll clean messy data as it comes in the real world and then embark on Stage 2 of our class data gathering project.</p>

<h2>Housekeeping</h2>

<ul>
<li>General thoughts on project pitches: think small + manageable</li>
<li>Project requirements and <a href="../projects/">a look forward</a></li>
<li>Sarah, Cayleigh, &amp; Kristin are leading a discussion on <a href="http://projects.propublica.org/drug-labels/">drug labels</a></li>
<li>When things are <a href="http://jigsaw.w3.org/css-validator/">broken</a>.</li>
</ul>

<h2>Part 1: Data in the real world</h2>

<p>Unfortunately, data doesn&rsquo;t always come formatted the way we like. Let&rsquo;s take a recent example from last year with some data about successful gun traces out of Chicago. (A <a href="http://www.atf.gov/publications/factsheets/factsheet-national-tracing-center.html">gun trace</a> is where they find out where a gun found in a crime was purchased.) After some phone calls, you get your hands on some source data. Go ahead and <a href="county-data.txt">download it</a> and open it in a spreadsheet.</p>

<ol>
<li><p>Take a look at the data. What does one row look like? What does our dream data set look like? Do the things we always do: know dimensions, make a copy, give the columns names.</p></li>
<li><p>Let&rsquo;s think of questions we might ask of our dream data set instead of this data set. What are some headlines we wish we could be able to write? Add a couple of your own in <a href="https://docs.google.com/document/d/19bZ5tU5acdgRGX45qU_MPYHaCMNaP1cQap094SkXs6o/edit?usp=sharing">this Google Doc</a>. This is a &lsquo;hat-on&rsquo; exercise, so don&rsquo;t be shy.</p></li>
<li><p>Name the sheet <code>traces</code>. How sad does this data make us? </p></li>
<li><p>Make columns called <code>county_clean</code> and <code>state_clean</code> that has just have counties and states only. </p></li>
<li><p>How useful would a pivot table of county_clean be? Do a filter in <code>clean_county</code> for &ldquo;Washington&rdquo;. </p></li>
<li><p>It&rsquo;s pretty clear that we need some data that has unique values for each county. Google &ldquo;US county fips codes&rdquo; and see what the Census has to offer (though any of them are probably fine, we should stick to government data). Save the file locally and enter it as a second sheet in your main Excel file. Call the sheet <code>FIPS</code>. <a class="hidden" href="https://www.census.gov/geo/reference/codes/files/national_county.txt">BLAMO</a> and clean it up, doing the normal things we do.</p></li>
<li><p>Be happy if your sheet looks like this:
<img src="Screenshot 2014-03-02 16.42.54.png"></p></li>
<li><p>Make a new column for the 5-digit county FIPS code for each county. Call it <code>5_digit_fips</code>. There are lots of ways to do this.</p></li>
<li><p>How are we going to join our data?</p></li>
<li><p>Remove the word &ldquo;county&rdquo; from <code>county_name</code> in a new field called <code>county2</code>.</p></li>
<li><p><em>In both sheets</em>, make a new column called <code>joinfield</code> that pastes the county name and state together, separated by a hyphen. You might need to do this in steps.</p></li>
<li><p>We&rsquo;re ready to make a crude attempt a vlookup. Try to get a column called &ldquo;county_fips&rdquo; in your traces sheet.</p></li>
<li><p>Which ones didn&rsquo;t match? Why?</p></li>
<li><p>Make a new field called is_error that gives you a 1 if there is an error and a zero if there is not.</p></li>
<li><p>Sort your traces data by is_error and then count, both decreasing. This will let you prioritize your targets and quantitatively answer how good our merge was. How many do we need to fix? </p></li>
<li><p>Seek and destroy! There&rsquo;s no wrong way to do this, but some ways are righter than others. Keep going until you have matched <em>98 percent of guns and are not missing any counties with more than 30 guns traced</em>. (Protip: a pivot table of <code>is_error</code> and sum of <code>count</code> will be helpful.)</p></li>
<li><p>With the FIPS codes, what can we do that we couldn&rsquo;t before?</p></li>
<li><p>Can we answer this question the way we did this join? &ldquo;What percent of counties had at least one gun traced to Chicago?&rdquo;</p></li>
<li><p>One stats program called R would let us map these without too much trouble. What questions might these maps lead you to ask? Where might you go to get answers?
<img src="http://kpq.github.io/r-tutorials/assets/images/chicago-map-10.png">
<img src="http://kpq.github.io/r-tutorials/assets/images/chicago-map-12.png"></p></li>
<li><p>Here&rsquo;s the <a href="http://www.nytimes.com/interactive/2013/01/29/us/where-50000-guns-in-chicago-came-from.html?ref=us">NYT take</a> and <a href="http://www.nytimes.com/2013/01/30/us/strict-chicago-gun-laws-cant-stem-fatal-shots.html?pagewanted=all">story</a>.</p></li>
</ol>

<h2>Where we left off.</h2>

<p>The typical graduation rates reported for colleges are broken, in part because transfer students are counted in the same way as drop-outs. How could you fix this? </p>

<ul>
<li><p>Some schools voluntarily give their progress data to a group called <a href="http://www.collegeportraits.org/">College Portraits</a>. Here is a <a href="http://www.collegeportraits.org/SC/USC-Upstate/tracker">sample report</a>. But even friendly people associated with that project don&rsquo;t know they have the data in a database. I suspect they do, but I&rsquo;m not sure. I have scraped the data, and done some work to standardize it for you <a href="college-grad-and-transfer-rates.xlsx">here</a>. For the extra curious, here is some <a href="collegeportraits.r">horrible code</a>.</p></li>
<li><p>Note that there are some small difference between the <a href="http://www.collegeportraits.org/AL/AU/tracker">2013 reports</a> and the <a href="http://www.collegeportraits.org/AL/JSU/tracker">2012 ones</a>.</p></li>
<li><p>Take 20 minutes to explore the data, generating a list of questions, facts, and weirdness you uncover <a href="https://docs.google.com/document/d/1QVt45d0JfwLfa0RQtjULr68jZeWFKqEN6Ij4RU5sGVY/edit#">here</a>. Your goal is questions that are both answerable and could turn into interesting ledes. </p></li>
<li><p>Let&rsquo;s come up with a gameplan for collecting the data for the biggest schools. What do we need? </p></li>
<li><p>Let&rsquo;s practice aggregating to see how far we have to go. Here&rsquo;s <a href="list-of-schools.csv">something</a> for that. </p></li>
<li><p>In the doc with your questions, let&rsquo;s draft a request for data from a school.</p></li>
<li><p>Don&rsquo;t try to be too complicated at the beginning. Start with very easy questions - think averages, top 10 lists, outliers. After you have those answers, then you can add fanciness.</p></li>
<li><p>We are looking for things that we don&rsquo;t expect. <a href="http://www.washingtonmonthly.com/college_guide/rankings_2013/national_university_rank.php">Washington Monthly&rsquo;s rankings</a> are based on the same idea.</p></li>
<li><p>Find two schools that with similar characteristics, but very different graduation rates.</p></li>
</ul>

<h2>Expanding our college graduation sample. If we were to try, how far would we have to go?</h2>

<p>Here&rsquo;s <a href="../pieces-together-interviewing-data/list-of-schools.csv">a list of schools</a> for that. How many schools would we have to contact if we wanted to cover, say, half of the nation&rsquo;s undergraduates? 75%? How else could we restrict our sample?</p>

<h2>Write our letter.</h2>

<p>Let&rsquo;s do it together <a href="https://docs.google.com/document/d/1QVt45d0JfwLfa0RQtjULr68jZeWFKqEN6Ij4RU5sGVY/edit#">here</a>.</p>

<h2>Homework</h2>

<p>You have two choices. You may fill out 40 rows with contact information in <a href="https://docs.google.com/spreadsheet/ccc?key=0AvKWOz9eYW7ydGxfNnRGWnI4Vm9mT0thRnc2U2dSYWc#gid=0">this document</a>. Or you may embark on your own data collection project of a similar scale. If you choose the later, please push it to your github page.</p>

</div>


        </div> <!-- /main -->

        <script src="/assets/base.js" charset="utf-8"></script>

    </body>
</html>
